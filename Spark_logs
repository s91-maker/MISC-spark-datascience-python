 # 2files have quotes enclosed fields, 1 file have no quotes enclosing fields

>>> df = spark.read.csv(hdfs+'/data/satya/ml_rd/*.csv', header=True, inferSchema=True)
>>> df.count()
18/05/16 15:41:14 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
69
>>> df.printSchema()
root
 |-- City_V: string (nullable = true)
 |-- Country_V: string (nullable = true)
 |-- Country_Code_V: string (nullable = true)
 |-- Region_V: string (nullable = true)
 |-- defaultRole_V: string (nullable = true)
 |-- business_V: string (nullable = true)
 |-- tenantId_V: string (nullable = true)
 |-- Sales_F: string (nullable = true)   ########### SHOULD BE DOUBLE BUT Become String????????
 |-- OrderDate_D: string (nullable = true)
 |-- CallID_N: string (nullable = true)
 |-- DateINTCreated_V: string (nullable = true)
 |-- DimBusinessProgramID_N: string (nullable = true)
 |-- Dim_BusinessID_N: string (nullable = true)
 |-- DimSiteID_N: string (nullable = true)
 |-- DimSite_V: string (nullable = true)
 |-- DimLanguageID_N: string (nullable = true)
 |-- DimLanguage_V: string (nullable = true)
 |-- DimContactchannelID_N: string (nullable = true)
 |-- DATE_KEY_V: string (nullable = true)
 |-- DimApplicationID_N: string (nullable = true)
 |-- ApplicationNumber_N: string (nullable = true)
 |-- ApplicationName_V: string (nullable = true)
 |-- WaitingTime_N: string (nullable = true)
 |-- TalkTime_N: string (nullable = true)
 |-- HoldTime_N: string (nullable = true)
 |-- WrapupTime_N: string (nullable = true)
 |-- AgentNameACD_V: string (nullable = true)
 |-- IsAnswered_N: string (nullable = true)
 |-- SkillID_N: string (nullable = true)
 |-- QUEUETIME_N: string (nullable = true)
 |-- RINGTIME_N: string (nullable = true)
 |-- OrderID_N: string (nullable = true)
 |-- Profit_F: string (nullable = true)
 |-- SubOrder_ID_N: string (nullable = true)
 |-- ShipDate_D: string (nullable = true)
 |-- CityLatitude_V: string (nullable = true)
 |-- CityLongitude_V: string (nullable = true)
 |-- CountryLatitude_V: string (nullable = true)
 |-- CountryLongitude_V: string (nullable = true)

#### READ file with quote Enclosed.......Result is as expected, schema inferred correctly
>>> df_wq1 = spark.read.csv(hdfs+'/data/satya/ml_rd/TransactionDataApril2019_withQ.csv', header=True, inferSchema=True)
>>> df_wq1.printSchema()
root
 |-- City_V: string (nullable = true)
 |-- Country_V: string (nullable = true)
 |-- Country_Code_V: string (nullable = true)
 |-- Region_V: string (nullable = true)
 |-- defaultRole_V: string (nullable = true)
 |-- business_V: string (nullable = true)
 |-- tenantId_V: integer (nullable = true)
 |-- Sales_F: double (nullable = true)      ################## DOUBLE AS EXPECTED
 |-- OrderDate_D: string (nullable = true)
 |-- CallID_N: integer (nullable = true)
 |-- DateINTCreated_V: integer (nullable = true)
 |-- DimBusinessProgramID_N: integer (nullable = true)
 |-- Dim_BusinessID_N: integer (nullable = true)
 |-- DimSiteID_N: integer (nullable = true)
 |-- DimSite_V: string (nullable = true)
 |-- DimLanguageID_N: integer (nullable = true)
 |-- DimLanguage_V: string (nullable = true)
 |-- DimContactchannelID_N: integer (nullable = true)
 |-- DATE_KEY_V: integer (nullable = true)
 |-- DimApplicationID_N: integer (nullable = true)
 |-- ApplicationNumber_N: integer (nullable = true)
 |-- ApplicationName_V: string (nullable = true)
 |-- WaitingTime_N: integer (nullable = true)
 |-- TalkTime_N: integer (nullable = true)
 |-- HoldTime_N: integer (nullable = true)
 |-- WrapupTime_N: integer (nullable = true)
 |-- AgentNameACD_V: string (nullable = true)
 |-- IsAnswered_N: integer (nullable = true)
 |-- SkillID_N: integer (nullable = true)
 |-- QUEUETIME_N: integer (nullable = true)
 |-- RINGTIME_N: integer (nullable = true)
 |-- OrderID_N: integer (nullable = true)
 |-- Profit_F: double (nullable = true)
 |-- SubOrder_ID_N: integer (nullable = true)
 |-- ShipDate_D: string (nullable = true)
 |-- CityLatitude_V: double (nullable = true)
 |-- CityLongitude_V: double (nullable = true)
 |-- CountryLatitude_V: double (nullable = true)
 |-- CountryLongitude_V: double (nullable = true)


# Reading file without any quote enclosed file.............Result is as expected, schema inferred correctly
>>> df_wtq = spark.read.csv(hdfs+'/data/satya/ml_rd/TransactionDataApril2021_withoutQ.csv', header=True, inferSchema=True)
>>> df_wtq.printSchema()
root
 |-- City_V: string (nullable = true)
 |-- Country_V: string (nullable = true)
 |-- Country_Code_V: string (nullable = true)
 |-- Region_V: string (nullable = true)
 |-- defaultRole_V: string (nullable = true)
 |-- business_V: string (nullable = true)
 |-- tenantId_V: integer (nullable = true)
 |-- Sales_F: double (nullable = true)   ################ DOUBLE AS EXPECTED
 |-- OrderDate_D: string (nullable = true)
 |-- CallID_N: integer (nullable = true)
 |-- DateINTCreated_V: integer (nullable = true)
 |-- DimBusinessProgramID_N: integer (nullable = true)
 |-- Dim_BusinessID_N: integer (nullable = true)
 |-- DimSiteID_N: integer (nullable = true)
 |-- DimSite_V: string (nullable = true)
 |-- DimLanguageID_N: integer (nullable = true)
 |-- DimLanguage_V: string (nullable = true)
 |-- DimContactchannelID_N: integer (nullable = true)
 |-- DATE_KEY_V: integer (nullable = true)
 |-- DimApplicationID_N: integer (nullable = true)
 |-- ApplicationNumber_N: integer (nullable = true)
 |-- ApplicationName_V: string (nullable = true)
 |-- WaitingTime_N: integer (nullable = true)
 |-- TalkTime_N: integer (nullable = true)
 |-- HoldTime_N: integer (nullable = true)
 |-- WrapupTime_N: integer (nullable = true)
 |-- AgentNameACD_V: string (nullable = true)
 |-- IsAnswered_N: integer (nullable = true)
 |-- SkillID_N: integer (nullable = true)
 |-- QUEUETIME_N: integer (nullable = true)
 |-- RINGTIME_N: integer (nullable = true)
 |-- OrderID_N: integer (nullable = true)
 |-- Profit_F: double (nullable = true)
 |-- SubOrder_ID_N: integer (nullable = true)
 |-- ShipDate_D: string (nullable = true)
 |-- CityLatitude_V: double (nullable = true)
 |-- CityLongitude_V: double (nullable = true)
 |-- CountryLatitude_V: double (nullable = true)
 |-- CountryLongitude_V: double (nullable = true)

>>> df_app = df_wq1.union(df_wtq)      # read separately and appended by union, works AS EXPECTED(schema inferred correctly)
>>> df_app.printSchema()
root
 |-- City_V: string (nullable = true)
 |-- Country_V: string (nullable = true)
 |-- Country_Code_V: string (nullable = true)
 |-- Region_V: string (nullable = true)
 |-- defaultRole_V: string (nullable = true)
 |-- business_V: string (nullable = true)
 |-- tenantId_V: integer (nullable = true)
 |-- Sales_F: double (nullable = true)  ################## DOUBLE AS EXpected
 |-- OrderDate_D: string (nullable = true)
 |-- CallID_N: integer (nullable = true)
 |-- DateINTCreated_V: integer (nullable = true)
 |-- DimBusinessProgramID_N: integer (nullable = true)
 |-- Dim_BusinessID_N: integer (nullable = true)
 |-- DimSiteID_N: integer (nullable = true)
 |-- DimSite_V: string (nullable = true)
 |-- DimLanguageID_N: integer (nullable = true)
 |-- DimLanguage_V: string (nullable = true)
 |-- DimContactchannelID_N: integer (nullable = true)
 |-- DATE_KEY_V: integer (nullable = true)
 |-- DimApplicationID_N: integer (nullable = true)
 |-- ApplicationNumber_N: integer (nullable = true)
 |-- ApplicationName_V: string (nullable = true)
 |-- WaitingTime_N: integer (nullable = true)
 |-- TalkTime_N: integer (nullable = true)
 |-- HoldTime_N: integer (nullable = true)
 |-- WrapupTime_N: integer (nullable = true)
 |-- AgentNameACD_V: string (nullable = true)
 |-- IsAnswered_N: integer (nullable = true)
 |-- SkillID_N: integer (nullable = true)
 |-- QUEUETIME_N: integer (nullable = true)
 |-- RINGTIME_N: integer (nullable = true)
 |-- OrderID_N: integer (nullable = true)
 |-- Profit_F: double (nullable = true)
 |-- SubOrder_ID_N: integer (nullable = true)
 |-- ShipDate_D: string (nullable = true)
 |-- CityLatitude_V: double (nullable = true)
 |-- CityLongitude_V: double (nullable = true)
 |-- CountryLatitude_V: double (nullable = true)
 |-- CountryLongitude_V: double (nullable = true)
